<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
        Remove this if you use the .htaccess -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>HEROES</title>
        <meta name="description" content="It is a simple map base" />
        <!-- again, annoying meta name="viewport" content="width=device-width; initial-scale=1.0" /-->
        <!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

        <link rel="stylesheet" href="../map/map_style.css" />

        <script type="text/javascript" charset="utf-8" src="../map/jquery.min.1.7.2.js"></script>
        <script type="text/javascript" charset="utf-8">
var $CLIENT = true
//(function(){

MAP = {
    OFB: null,
    EMPTY: 0,
    //HERO: 1,
}

function Map1(){
    this.w = 5 //x
    this.h = 4 //y
    this.tiles = {}
    this.init()
}


Map1.prototype.init = function(){
    for (var x=0; x < this.w; x++) {
        for (var y=0; y < this.h; y++) {
            this.tiles[x+'_'+y] = MAP.EMPTY
        };
    };
}

Map1.prototype.get = function(x,y){
    if( x >= this.w ) return MAP.OFB
    if( y >= this.h ) return MAP.OFB
    return this.tiles[x+'_'+y]
}

Map1.prototype.set = function(x,y,obj){
    if( x >= this.w ) return false
    if( y >= this.h ) return false
    this.tiles[x+'_'+y] = obj
    return true
}

Map1.prototype.inspect = function(){
    for(var key in this.tiles){
        console.log(key,this.tiles[key])
    }
}









function HP(max){
    this.max = max
    this.current = max
}

HP.prototype.rate = function(){
    return current/max
}

function Animation(classe, aName, aDuration, aIC, aTF){
    this.classe = classe || ""
    this['animation-name'] = aName || 'jumpy'
    this['animation-duration'] = aDuration || "1s"
    this['animation-iteration-count'] = aIC || 'infinite'
    this['animation-timing-function'] = aTF || 'ease-in-out'
}

function SelectionRange(shape, width, height){
    this.shape = shape
    this.w = width
    this.h = height
}



/**
 * should only come as 'self', 'ally', 'enemy', 'empty'
 */
function Target(config){
    if( typeof config != 'object' ) throw( new Error('param') )
    this.all = config
}

Target.prototype.alow = function(type){
    return !!this.all[type]
}

function Selection(){
    
}

function Damage(base, interval, critRatio){
    this.base = base
    this.interval = interval
    this.critRatio = critRatio || 0
}

Damage.prototype.roll = function(){
    var output = this.base+((1+Math.random())*this.interval)
    var critTrigged = false
    if( Math.random() < this.critRatio ){
        output *= 1.4
        critTrigged = true
    }
    return {
        raw: Math.floor(output),
        critical: critTrigged,
    }
}

Damage.prototype.inspect = function(){
    var o = this.roll()
    console.log("Damage",this.base, this.interval, this.critRatio, o.raw, o.critical)
}

function Action(){
    
}

function SushiHero(){
    this.id = "sushi"
    this.name = "Mad Sushi Man"
    this.description = "After his wife and son got killed by sharks he sees fish in the face of anyone! So technically he is not trying to kill you, just doing his job."
    this.hp = new HP(base.max_hp)
    this.def = 0.3
    if( typeof window != undefined && window.$CLIENT ){
        this.baseAnimation = {
            alive: new Animation('sushi-alive'),
            dead:  new Animation('sushi-dead'),
        }
    } else
        this.baseAnimation = {}
    
}

//})()



//var hero = new Hero();

        </script>
<script type="text/javascript" charset="utf-8">
    function run(){
        dmgTest()
    }
    
    function dmgTest(){
        var d = new Damage(5,2,0.15)
        d.inspect();d.inspect();d.inspect();d.inspect();
    }
    function map1Test(){
        var m = new Map1()
        m.inspect()
    }
</script>
    </head>
    <body>
        <div id="container" class="full">
            <button type="button" onclick="dmgTest()">dmgTest</button>
            <button type="button" onclick="map1Test()">map1Test</button>
        </div>
    </body>
</html>
